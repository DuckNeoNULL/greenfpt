<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />

    <link rel="stylesheet" href="./global.css" />
    <link rel="stylesheet" href="./Login.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap"
    />
  </head>
  <body>
    <div class="homepage-cha-ng-nhp">
      <header class="component-2">
        <div class="container"></div>
        <div class="header">
          <img
            class="logo-trng-i-hc-fptsvg-icon8"
            loading="lazy"
            alt=""
            src="./public/img/logo-trng-i-hc-fptsvg@2x.png"
          />

          <div class="navigation2">
            <div class="menu">
              <button class="menu-items">
                <a href="./index.html" class="homepage8">Homepage</a>
              </button>
              <button class="menu-items">
                <a href="./subweb/d-o-n-e-e-event.html" class="homepage8">E-events</a>
              </button>
              <button class="menu-items">
                <a href="./subweb/d-o-n-e-plastic-cups-grow-plants-cong-ty-doi-tac-3.html" class="homepage8">Trade plants</a>
              </button>
              <button class="menu-items">
                <a href="./subweb/d-o-n-e-q-a.html" class="homepage8">Q&A</a>
              </button>
              <button class="menu-items">
                <a href="./subweb/d-o-n-e-about-us.html" class="homepage8">About us</a>
              </button>
            </div>
          </div>
        </div>
        <div class="auth">
          <div class="auth-options">
            <button class="auth-option-items">
              <a class="log-in">Log in</a>
            </button>
            <button  class="auth-option-items1">
              <a href="./subweb/d-o-n-e-register.html" class="register">Register</a>
            </button>
          </div>
        </div>
      </header>
      <section class="login">
        <img class="pngegg-1-icon" alt="" src="./public/img/pngegg-1@2x.png" />

        <form class="login-inputs">
          <h1 class="log-in1">log in</h1>
          <div class="input-fields">
            <div class="phone-email">
              <div class="contact-options">
                <div class="telephone-number">Telephone number</div>
                <div class="email2">Email</div>
              </div>
              <img
                class="phone-email-child"
                loading="lazy"
                alt=""
                src="./public/img/group-478.svg"
              />
            </div>
            <div class="email-parent">
              <input class="email3" placeholder="Email " type="text" />

              <div class="frame-child6"></div>
            </div>
          </div>
          <div class="password-parent">
            <!-- Change type to "password" for security -->
            <input class="password" placeholder="Password" type="password" />
            <div class="frame-child7"></div>
          </div>
          <div class="error-message">incorrect password or username</div>
          <button class="password-input">
            <div class="log-in2">Log in</div>
          </button>
          <div class="remember-forget">
            <div class="remember">
              <input class="remember-checkbox" type="checkbox" />

              <div class="remember-label">
                <div class="remember1">Remember</div>
              </div>
            </div>
            <div class="forget">
              <div class="forget1">Forget?</div>
            </div>
          </div>
          <div class="separator">
            <div class="separator-inner">
              <div class="line-div"></div>
            </div>
            <div class="or">OR</div>
            <div class="separator-child">
              <div class="frame-child8"></div>
            </div>
          </div>
          <b class="register1">Register?</b>
        </form>
      </section>
    </div>
    <script>
      function togglePasswordVisibility() {
        const passwordInput = document.querySelector('.password');
        const viewHideIcon = document.querySelector('.view-hide-icon');
        if (passwordInput.type === 'password') {
          passwordInput.type = 'text';
          viewHideIcon.src = './public/img/hide-password-icon.png'; // Update with your hide icon path
        } else {
          passwordInput.type = 'password';
          viewHideIcon.src = './public/img/view-hide@2x.png'; // Update with your view icon path
        }
      }
      document.querySelector('.login-inputs').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent the default form submission

        // Get the email and password input values
        const emailInput = document.querySelector('.email3');
        const passwordInput = document.querySelector('.password');
        const email = emailInput.value;
        const password = passwordInput.value;

        // Do something with the email and password values
        // Clear the input fields
        emailInput.value = '';
        passwordInput.value = '';
        // Extract form data
        const data = {
          username: email,
          password: password
        };
        // Send data to server
        fetch('/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data),
        })
        .then(response => {
          if (response.ok) {
            return response.json();
          } else if (response.status === 401) {
            throw new Error('Login failed: Invalid username or password');
            
          } else {
            throw new Error('An unexpected error occurred');
          }
        })
        .then(data => {
          console.log('Login successful:', data.userId);
          localStorage.setItem('userId', data.userId);
          // Store token and userId in localStorag
          // Redirect or update UI as needed
           window.location.href = '/subweb/dashboard.html'; // Adjust as necessary --> -->
        })
        .catch((error) => {
          console.error('Login failed:', error);
        });
      });
    </script>
  </body>
</html>
